<% content_for :page_title, t("sign.app.registration.new.page_title") %>
<% product_name = ENV.fetch("BRAND_NAME") { ENV.fetch("NAME", "Umaxica") } %>

<section class="space-y-12" data-testid="registration-page">
  <header class="space-y-4">
    <h1 class="text-3xl font-bold text-slate-900 md:text-4xl"><%= t("sign.app.registration.new.page_title") %></h1>
    <p class="max-w-2xl text-base text-slate-600"><%= t("sign.app.registration.new.page_description", product: product_name) %></p>
  </header>

  <section class="space-y-4" data-testid="registration-methods">
    <h2 class="text-lg font-semibold text-slate-900"><%= t("sign.app.registration.new.methods.title") %></h2>
    <div class="grid gap-4 md:grid-cols-2">
      <% @registration_methods.each do |method| %>
        <% translation_scope = "sign.app.registration.new.methods.#{method[:key]}" %>
        <article class="flex h-full flex-col justify-between rounded-lg border border-slate-200 bg-white p-6 shadow-sm" data-testid="registration-method">
          <div>
            <h3 class="text-xl font-semibold text-slate-900"><%= t("#{translation_scope}.title") %></h3>
            <p class="mt-2 text-sm text-slate-600"><%= t("#{translation_scope}.description", product: product_name) %></p>
          </div>
          <div class="mt-6">
            <%= link_to t("#{translation_scope}.cta"),
                        method[:path],
                        class: "inline-flex items-center rounded-md bg-slate-900 px-4 py-2 text-sm font-medium text-white transition hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2" %>
          </div>
        </article>
      <% end %>
    </div>
  </section>

  <section class="space-y-4" data-testid="registration-social">
    <h2 class="text-lg font-semibold text-slate-900"><%= t("sign.app.registration.new.social.title") %></h2>
    <p class="text-sm text-slate-600"><%= t("sign.app.registration.new.social.description", product: product_name) %></p>
    <div class="flex flex-col gap-3 md:flex-row">
      <% @social_providers.each do |provider| %>
        <% translation_scope = "sign.app.registration.new.social.buttons.#{provider[:key]}" %>
        <%= form_with url: provider[:path],
                      method: provider[:method],
                      data: provider[:data],
                      local: true,
                      html: { class: "w-full md:w-auto" } do %>
          <button type="submit" class="inline-flex w-full items-center justify-center rounded-md border border-slate-200 bg-white px-4 py-2 text-sm font-medium text-slate-900 shadow-sm transition hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 md:w-auto">
            <span><%= t(translation_scope) %></span>
          </button>
        <% end %>
      <% end %>
    </div>
    <p class="text-xs text-slate-500"><%= t("sign.app.registration.new.social.disclaimer") %></p>
  </section>

  <section data-testid="registration-sign-in">
    <p class="text-sm text-slate-700">
      <%= t("sign.app.registration.new.links.sign_in_html",
            link: link_to(
              t("sign.app.registration.new.links.sign_in_text"),
              new_sign_app_authentication_path,
              class: "font-medium underline"
            )).html_safe %>
    </p>
  </section>
</section>
