<% scope = local_assigns.fetch(:scope, :app).to_s %>
<% title t("apex.app.preference.locale.edit.title") %>

<div class="max-w-2xl mx-auto py-8 px-4">
  <header class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2">
      <%= t("apex.#{scope}.preference.locale.edit.title") %>
    </h1>
    <p class="text-gray-600 dark:text-gray-400">
      <%= t("apex.#{scope}.preference.locale.edit.description") %>
    </p>
  </header>

  <%= form_with url: public_send("apex_#{scope}_preference_locale_path"), method: :patch, class: "space-y-6" do |f| %>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4">
        <%= t("apex.#{scope}.preference.locale.edit.language_section") %>
      </h2>
      <div class="space-y-2">
        <%= f.label :language, t("apex.#{scope}.preference.locale.edit.language_label"),
                    class: "block text-sm font-medium text-gray-700 dark:text-gray-300" %>
        <%= f.select :language,
                     options_for_select(
                       [
                         [t("apex.#{scope}.preference.locale.edit.language_options.ja"), "ja"],
                         [t("apex.#{scope}.preference.locale.edit.language_options.en"), "en"]
                       ],
                       (@current_language.presence || "JA").downcase
                     ),
                     { prompt: t("apex.#{scope}.preference.locale.edit.language_prompt") },
                     class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100" %>
      </div>
    </div>

    <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
      <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4">
        <%= t("apex.#{scope}.preference.locale.edit.timezone_section") %>
      </h2>
      <div class="space-y-2">
        <%= f.label :timezone, t("apex.#{scope}.preference.locale.edit.timezone_label"),
                    class: "block text-sm font-medium text-gray-700 dark:text-gray-300" %>
        <%= f.select :timezone,
                     options_for_select(
                       [
                         [t("apex.#{scope}.preference.locale.edit.timezone_options.UTC"), "Etc/UTC"],
                         [t("apex.#{scope}.preference.locale.edit.timezone_options.JST"), "Asia/Tokyo"]
                       ],
                       @current_timezone_identifier.presence || "Asia/Tokyo"
                     ),
                     { prompt: t("apex.#{scope}.preference.locale.edit.timezone_prompt") },
                     class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100" %>
      </div>
    </div>

    <div class="flex gap-3">
      <%= f.submit t("apex.#{scope}.preference.locale.edit.submit"),
                   class: "px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-md transition-colors duration-200 cursor-pointer" %>
    </div>
  <% end %>

  <div class="mt-6">
    <%= link_to t("apex.#{scope}.preferences.back_to_settings"),
                public_send("apex_#{scope}_preference_path"),
                class: "inline-block px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium rounded-md transition-colors duration-200" %>
  </div>
</div>
